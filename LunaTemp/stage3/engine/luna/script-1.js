!function(){if(window.pc={markPhysics2dModuleAsUsed(){},markPhysics3dModuleAsUsed(){}},!DEVELOP)return;const s={Physics3d:"physics3d",Physics2d:"physics2d",ParticleSystem:"particle-system"};const e=new class{constructor(){this.classes=new Map,this.methods=new Map,this.unusedModules=new Set([s.Physics3d,s.Physics2d,s.ParticleSystem]),this.saveTimerId=null,this.allClassesAreDefined=!1,window.addEventListener("luna:starting",(()=>{this.allClassesAreDefined=!0}))}registerClass(s){this.classes.has(s)||(this.classes.set(s,!0),this.save())}markClassAsUsed(s){this.classes.has(s)&&!1!==this.classes.get(s)&&(this.classes.set(s,!1),this.save())}registerMethod(s,e){this.methods.has(s)||this.methods.set(s,new Map);const t=this.methods.get(s);t.has(e)||(t.set(e,!0),this.save())}markMethodAsUsed(s,e){this.methods.has(s)||this.methods.set(s,new Map);const t=this.methods.get(s);!1!==t.get(e)&&(t.set(e,!1),this.save())}markModuleAsUsed(s){this.unusedModules.delete(s)}serialize(){const s=new Set(window.$environment.forceIncludedClasses),e=[...this.classes.entries()].filter((([s,e])=>e)).filter((([e])=>!s.has(e))).map((([s])=>({name:s,excluded:!0}))),t=[];for(const i of this.methods.keys()){if(!0===this.classes.get(i))continue;if(s.has(i))continue;const n=[...this.methods.get(i).entries()].map((([s,e])=>({name:s,excluded:e})));0===n.length&&e.push({name:i,excluded:!1}),t.push({className:i,staticMethods:[],instanceMethods:n})}for(const[t,i]of this.classes.entries()){const n=!i&&!this.methods.has(t),r=s.has(t);(n||r)&&e.push({name:t,excluded:!1})}return JSON.stringify({unusedClasses:e,unusedMethods:t,unusedModules:[...this.unusedModules]})}save(){this.saveTimerId&&clearTimeout(this.saveTimerId),this.saveTimerId=setTimeout((()=>{this.saveTimerId=null,this.allClassesAreDefined?fetch(window.location.origin+"/tracing",{method:"POST",body:this.serialize()}):this.save()}),100)}};function t(s){if(!s)return null;const e=s.$$fullname||s.$$name;return e?e.replace("+","."):null}function i(s,i,n){!Bridge.Class.$queue.includes(s)&&s.prototype&&Bridge.Class.$queue.push(s),e.markClassAsUsed(i);const r=[];s.$$inherits&&s.$$inherits.forEach((function s(e){n.has(e)||(n.add(e),e.$$inherits&&e.$$inherits.forEach(s),e.$genericTypeDefinition?(s(e.$genericTypeDefinition),e.$typeArguments.forEach(s)):r.push(t(e)))})),r.filter((s=>s)).forEach((s=>e.markClassAsUsed(s)))}window.traceResults=e,e.EngineModules=s,window.TRACE=(s,t)=>{if(Array.isArray(s))for(let t=0;t<s.length;t++){const i=s[t],[n,...r]=i.split("#");e.registerClass(n),e.registerMethod(n,r.join("#"))}else{const[t,...i]=s.split("#");e.markClassAsUsed(t),e.markMethodAsUsed(t,i.join("#"))}};const n=/TRACE\(\s*"(.+)"/;let r=null;Object.defineProperty(window,"Bridge",{get:()=>r,set(s){if(r===s)return;!function(s){let n=null;const r=function(r,a,o,h){return!(o||a&&a.$noRegister)&&e.registerClass(r),a?n.call(s,r,"function"==typeof a?function(s,e){const n=function(...n){const r=new Set,a=e(...n);return i({},s,r),n.forEach((s=>i(s,t(s),r))),Array.isArray(a.inherits)&&a.inherits.forEach((s=>i(s,t(s),r))),a};return Object.defineProperty(n,"length",{get:()=>e.length}),n.toString=()=>e.toString(),n.$aliasInit=e.$aliasInit,n}(r,a):function(s,e){let t=e.statics||e.$statics;t||(t={},e.statics=t),["fields","events","props","ctors","methods"].some((s=>s in t))&&(t.ctors=t.ctors||{},t=t.ctors);let n=t.ctor;return n||(n=()=>{},t.ctor=n),t.ctor=function(...e){const t=new Set;i(this,s,t),n.apply(this,e)},e}(r,a),o,h):n.call(s,r,a,o,h)};Object.defineProperty(s,"define",{get:()=>r,set(s){n=s}})}(s);const a=s.fn.cacheBind;s.fn.cacheBind=(s,e,t,i)=>{const r=function(s){const e=s.toString().match(n);return e&&e[1]?e[1]:null}(e);return r&&TRACE(r),a(s,e,t,i)},r=s}})}(),function(){if(!DEVELOP)return;window.shaderVariantsTraceResults=new class{constructor(){this.shaderVariants=new Map,this.saveTimerId=null}registerShaderVariant(s){const e=this.shaderVariants;e.has(s.id)||(e.set(s.id,s),this.save())}hasShaderVariant(s){return this.shaderVariants.has(s)}serialize(){const s=Array.from(this.shaderVariants.values());return JSON.stringify({variants:s})}save(){this.saveTimerId&&clearTimeout(this.saveTimerId),this.saveTimerId=setTimeout((()=>{fetch(window.location.origin+"/tracing/shader/variants",{method:"POST",body:this.serialize()})}),250)}}}();